<!DOCTYPE html>
<html class="writer-html5" lang="en" data-content_root="./">
<head>
  <meta charset="utf-8" /><meta name="viewport" content="width=device-width, initial-scale=1" />

  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <title>Examples for pagn &mdash; pagn  documentation</title>
      <link rel="stylesheet" type="text/css" href="_static/pygments.css?v=80d5e7a1" />
      <link rel="stylesheet" type="text/css" href="_static/css/theme.css?v=19f00094" />

  
  <!--[if lt IE 9]>
    <script src="_static/js/html5shiv.min.js"></script>
  <![endif]-->
  
        <script src="_static/jquery.js?v=5d32c60e"></script>
        <script src="_static/_sphinx_javascript_frameworks_compat.js?v=2cd50e6c"></script>
        <script src="_static/documentation_options.js?v=5929fcd5"></script>
        <script src="_static/doctools.js?v=888ff710"></script>
        <script src="_static/sphinx_highlight.js?v=dc90522c"></script>
        <script async="async" src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-mml-chtml.js"></script>
    <script src="_static/js/theme.js"></script>
    <link rel="index" title="Index" href="genindex.html" />
    <link rel="search" title="Search" href="search.html" />
    <link rel="next" title="API" href="api.html" />
    <link rel="prev" title="pAGN" href="index.html" /> 
</head>

<body class="wy-body-for-nav"> 
  <div class="wy-grid-for-nav">
    <nav data-toggle="wy-nav-shift" class="wy-nav-side">
      <div class="wy-side-scroll">
        <div class="wy-side-nav-search" >

          
          
          <a href="index.html" class="icon icon-home">
            pagn
          </a>
<div role="search">
  <form id="rtd-search-form" class="wy-form" action="search.html" method="get">
    <input type="text" name="q" placeholder="Search docs" aria-label="Search docs" />
    <input type="hidden" name="check_keywords" value="yes" />
    <input type="hidden" name="area" value="default" />
  </form>
</div>
        </div><div class="wy-menu wy-menu-vertical" data-spy="affix" role="navigation" aria-label="Navigation menu">
              <p class="caption" role="heading"><span class="caption-text">Contents:</span></p>
<ul class="current">
<li class="toctree-l1"><a class="reference internal" href="index.html">pAGN</a></li>
<li class="toctree-l1 current"><a class="current reference internal" href="#">Examples for pagn</a><ul>
<li class="toctree-l2"><a class="reference internal" href="#getting-started">Getting Started</a></li>
<li class="toctree-l2"><a class="reference internal" href="#evolving-agn-disks">Evolving AGN disks</a></li>
<li class="toctree-l2"><a class="reference internal" href="#custom-opacity">Custom Opacity</a></li>
<li class="toctree-l2"><a class="reference internal" href="#luminosities">Luminosities</a></li>
<li class="toctree-l2"><a class="reference internal" href="#use-case-migration-torques">Use Case: Migration Torques</a></li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="api.html">API</a></li>
</ul>

        </div>
      </div>
    </nav>

    <section data-toggle="wy-nav-shift" class="wy-nav-content-wrap"><nav class="wy-nav-top" aria-label="Mobile navigation menu" >
          <i data-toggle="wy-nav-top" class="fa fa-bars"></i>
          <a href="index.html">pagn</a>
      </nav>

      <div class="wy-nav-content">
        <div class="rst-content">
          <div role="navigation" aria-label="Page navigation">
  <ul class="wy-breadcrumbs">
      <li><a href="index.html" class="icon icon-home" aria-label="Home"></a></li>
      <li class="breadcrumb-item active">Examples for pagn</li>
      <li class="wy-breadcrumbs-aside">
            <a href="_sources/examples.rst.txt" rel="nofollow"> View page source</a>
      </li>
  </ul>
  <hr/>
</div>
          <div role="main" class="document" itemscope="itemscope" itemtype="http://schema.org/Article">
           <div itemprop="articleBody">
             
  <section id="examples-for-pagn">
<h1>Examples for pagn<a class="headerlink" href="#examples-for-pagn" title="Link to this heading"></a></h1>
<p>These are some of the examples for the pagn package; which uses the
equations from <a class="reference external" href="https://academic.oup.com/mnras/article/341/2/501/1105444">Sirko and Goodman
2003</a> and
<a class="reference external" href="https://iopscience.iop.org/article/10.1086/431923">Thompson et
al. 2005</a> to
evolve parametric Active Galactic Nuclei disks (AGNs).</p>
<section id="getting-started">
<h2>Getting Started<a class="headerlink" href="#getting-started" title="Link to this heading"></a></h2>
<p>First, import the models from the package:</p>
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="kn">from</span> <span class="nn">pagn</span> <span class="kn">import</span> <span class="n">Thompson</span>
<span class="kn">from</span> <span class="nn">pagn</span> <span class="kn">import</span> <span class="n">Sirko</span>
<span class="kn">import</span> <span class="nn">numpy</span> <span class="k">as</span> <span class="nn">np</span>
<span class="kn">import</span> <span class="nn">matplotlib.pyplot</span> <span class="k">as</span> <span class="nn">plt</span>
<span class="kn">import</span> <span class="nn">pagn.constants</span> <span class="k">as</span> <span class="nn">ct</span>
</pre></div>
</div>
<p>To quickly test pagn, try printing the default disk parameters:</p>
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">s</span> <span class="o">=</span> <span class="n">Sirko</span><span class="o">.</span><span class="n">SirkoAGN</span><span class="p">()</span>
<span class="n">t</span> <span class="o">=</span> <span class="n">Thompson</span><span class="o">.</span><span class="n">ThompsonAGN</span><span class="p">()</span>
</pre></div>
</div>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="c1">### Sirko &amp; Goodman 2003 parameters ###</span>
<span class="n">Mbh</span> <span class="o">=</span> <span class="mf">1.000000e+08</span> <span class="n">MSun</span>
<span class="n">Mdot</span> <span class="o">=</span> <span class="mf">1.298344e+00</span> <span class="n">MSun</span><span class="o">/</span><span class="n">yr</span>
<span class="n">le</span> <span class="o">=</span> <span class="mf">0.5</span>
<span class="n">Rs</span> <span class="o">=</span> <span class="mf">9.570121e-06</span> <span class="n">pc</span>
<span class="n">Rmin</span> <span class="o">=</span> <span class="mf">2.500000e+00</span> <span class="n">Rs</span>
<span class="n">Rmax</span> <span class="o">=</span> <span class="mf">1.000000e+07</span> <span class="n">Rs</span><span class="p">,</span> <span class="mf">9.570121e+01</span> <span class="n">pc</span>
<span class="n">alpha</span> <span class="o">=</span> <span class="mf">0.01</span>
<span class="n">b</span> <span class="o">=</span> <span class="mi">0</span>
<span class="n">eps</span> <span class="o">=</span> <span class="mf">0.1</span>
<span class="n">X</span> <span class="o">=</span> <span class="mf">0.7</span>
<span class="n">Opacity</span> <span class="o">=</span> <span class="n">combined</span>

<span class="n">debug</span> <span class="o">=</span> <span class="kc">False</span>
<span class="n">xtol</span> <span class="o">=</span> <span class="mf">1e-10</span>
<span class="n">root</span> <span class="n">method</span> <span class="o">=</span> <span class="n">lm</span>
<span class="n">sigma</span> <span class="kn">from</span> <span class="nn">M</span> <span class="n">using</span> <span class="n">M</span><span class="o">-</span><span class="n">sigma</span> <span class="n">relation</span>
<span class="c1">### Thompson et al. 2005 parameters ###</span>
<span class="n">Mbh</span> <span class="o">=</span> <span class="mf">1.000000e+08</span> <span class="n">MSun</span>
<span class="n">Mdot_out</span> <span class="o">=</span> <span class="mf">3.200000e+02</span> <span class="n">MSun</span><span class="o">/</span><span class="n">yr</span>
<span class="n">Rs</span> <span class="o">=</span> <span class="mf">9.570121e-06</span> <span class="n">pc</span>
<span class="n">Rin</span> <span class="o">=</span> <span class="mf">3.000000e+00</span> <span class="n">Rs</span>
<span class="n">Rout</span> <span class="o">=</span> <span class="mf">2.089838e+07</span> <span class="n">Rs</span> <span class="o">=</span> <span class="mf">2.000000e+02</span> <span class="n">pc</span>
<span class="n">sigma</span> <span class="o">=</span> <span class="mf">1.879994e+02</span> <span class="n">km</span><span class="o">/</span><span class="n">s</span>
<span class="n">epsilon</span> <span class="o">=</span>  <span class="mf">0.001</span>
<span class="n">m</span> <span class="o">=</span>  <span class="mf">0.2</span>
<span class="n">xi</span> <span class="o">=</span>  <span class="mf">1.0</span>
<span class="n">Opacity</span> <span class="o">=</span> <span class="n">combined</span>

<span class="n">debug</span> <span class="o">=</span> <span class="kc">False</span>
<span class="n">xtol</span> <span class="o">=</span> <span class="mf">1e-10</span>
<span class="n">root</span> <span class="n">method</span> <span class="o">=</span> <span class="n">lm</span>
</pre></div>
</div>
<p>The output should look the same as the one above. Once this small check
has been done, we can move on to evolving our disks.</p>
</section>
<section id="evolving-agn-disks">
<h2>Evolving AGN disks<a class="headerlink" href="#evolving-agn-disks" title="Link to this heading"></a></h2>
<p>Define input parameters for the AGN disk.</p>
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1">#Sirko &amp; Goodman 2003</span>
<span class="n">Mbh</span><span class="o">=</span><span class="mf">1e8</span><span class="o">*</span><span class="n">ct</span><span class="o">.</span><span class="n">MSun</span> <span class="c1">#10^8 solar mass SMBH</span>
<span class="n">le</span><span class="o">=</span><span class="mf">0.5</span> <span class="c1">#Eddington ratio</span>
<span class="n">Mdot</span><span class="o">=</span> <span class="kc">None</span> <span class="c1">#let the accretion rate be calculated through lE</span>
<span class="n">alpha</span><span class="o">=</span><span class="mf">0.01</span> <span class="c1">#standard Shakura Sunyaev parameter value</span>
<span class="n">X</span><span class="o">=</span><span class="mf">0.7</span> <span class="c1">#Hydrogen abundance is 0.7 for this disk</span>
<span class="n">b</span><span class="o">=</span><span class="mi">0</span> <span class="c1">#Let&#39;s see the alpha-disk case</span>
<span class="n">Opacity</span><span class="o">=</span><span class="s2">&quot;combined&quot;</span> <span class="c1">#most up to date opacity values</span>
</pre></div>
</div>
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1">#Thompson et al. 2005</span>
<span class="n">sigma</span> <span class="o">=</span> <span class="mf">300e3</span> <span class="c1">#stellar dispersion relation</span>
<span class="n">mbh</span> <span class="o">=</span> <span class="p">(</span><span class="mf">2e8</span><span class="o">*</span><span class="n">ct</span><span class="o">.</span><span class="n">MSun</span><span class="p">)</span> <span class="o">*</span> <span class="p">((</span><span class="n">sigma</span> <span class="o">/</span> <span class="mf">200e3</span><span class="p">)</span> <span class="o">**</span> <span class="mi">4</span><span class="p">)</span> <span class="c1">#let&#39;s use our own M-sigma relation to find mass</span>
<span class="n">epsilon</span><span class="o">=</span><span class="mf">1e-3</span> <span class="c1">#Star formation radiative efficiency</span>
<span class="n">m</span><span class="o">=</span> <span class="mf">0.2</span> <span class="c1">#Value for angular momentum efficiency as suggested by Thompson et al. 2005</span>
<span class="n">xi</span><span class="o">=</span> <span class="mf">1.</span> <span class="c1">#Approximate supernovae radiative fraction as suggested by Thompson et al. 2005</span>
<span class="n">Mdot_out</span><span class="o">=</span><span class="kc">None</span> <span class="c1">#For mbh in 10^8-10^9 Msun range, the outer accretion rate scaling should be sufficient for bright AGN formation</span>
<span class="n">Rout</span><span class="o">=</span><span class="kc">None</span> <span class="c1">#Let&#39;s use 1e7 Schwarzchild radii for outer boundary</span>
<span class="n">Rin</span><span class="o">=</span><span class="kc">None</span> <span class="c1">#Rin is 3 Schwarzchild radii</span>
<span class="n">opacity</span><span class="o">=</span><span class="s2">&quot;combined&quot;</span> <span class="c1">#most up to date opacity values</span>
</pre></div>
</div>
<p>We now solve the disk equations. Note that when calling the SirkoAGN and
ThompsonAGN models, there is a printout of the input parameters. This
can be used to check that the units have been correctly converted and
what the outputs of the scalings are.</p>
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="o">%%capture</span>
<span class="n">sk</span> <span class="o">=</span> <span class="n">Sirko</span><span class="o">.</span><span class="n">SirkoAGN</span><span class="p">(</span><span class="n">Mbh</span><span class="o">=</span><span class="n">Mbh</span><span class="p">,</span> <span class="n">le</span><span class="o">=</span><span class="n">le</span><span class="p">,</span> <span class="n">Mdot</span><span class="o">=</span><span class="n">Mdot</span><span class="p">,</span> <span class="n">alpha</span><span class="o">=</span><span class="n">alpha</span><span class="p">,</span> <span class="n">X</span><span class="o">=</span><span class="n">X</span><span class="p">,</span>
                    <span class="n">b</span><span class="o">=</span><span class="n">b</span><span class="p">,</span> <span class="n">opacity</span> <span class="o">=</span> <span class="n">Opacity</span><span class="p">)</span>
<span class="n">sk</span><span class="o">.</span><span class="n">solve_disk</span><span class="p">(</span><span class="n">N</span><span class="o">=</span><span class="mf">1e4</span><span class="p">)</span> <span class="p">;</span> <span class="c1">#10^4 tends to be a sufficient resolution for most Mbh values</span>
</pre></div>
</div>
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="o">%%capture</span>
<span class="n">tho</span> <span class="o">=</span> <span class="n">Thompson</span><span class="o">.</span><span class="n">ThompsonAGN</span><span class="p">(</span><span class="n">Mbh</span> <span class="o">=</span> <span class="n">mbh</span><span class="p">,</span> <span class="n">sigma</span> <span class="o">=</span> <span class="n">sigma</span><span class="p">,</span> <span class="n">epsilon</span> <span class="o">=</span> <span class="n">epsilon</span><span class="p">,</span> <span class="n">m</span> <span class="o">=</span> <span class="n">m</span><span class="p">,</span> <span class="n">xi</span> <span class="o">=</span> <span class="n">xi</span><span class="p">,</span>
                      <span class="n">Mdot_out</span><span class="o">=</span> <span class="n">Mdot_out</span><span class="p">,</span> <span class="n">Rout</span> <span class="o">=</span> <span class="n">Rout</span><span class="p">,</span> <span class="n">Rin</span> <span class="o">=</span> <span class="n">Rin</span><span class="p">,</span> <span class="n">opacity</span> <span class="o">=</span><span class="n">opacity</span><span class="p">)</span>
<span class="n">tho</span><span class="o">.</span><span class="n">solve_disk</span><span class="p">(</span><span class="n">N</span><span class="o">=</span><span class="mf">1e4</span><span class="p">)</span> <span class="p">;</span>
</pre></div>
</div>
<p>To quickly check that the Sirko &amp; Goodman model ran correctly, we can
plot some key parameters</p>
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">sk</span><span class="o">.</span><span class="n">plot</span><span class="p">()</span>
</pre></div>
</div>
<img alt="_images/output_16_0.png" src="_images/output_16_0.png" />
<p>The Sirko &amp; Goodman model tends to be simpler than the Thompson et al
model. We expect the temperature of the disk to decrease with distance
from the central BH, starting at values of <span class="math notranslate nohighlight">\(10^5-10^6\)</span> Kelvin,
depending on the mass of the central BH. The h/r ratio should stay below
one, at least in the inner regions of the disk. The vertical line shows
where we have switched from the inner regime to the outer regime.</p>
<p>We can similarly check the Thompson et al model ran correctly.</p>
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">tho</span><span class="o">.</span><span class="n">plot</span><span class="p">()</span>
</pre></div>
</div>
<img alt="_images/output_19_0.png" src="_images/output_19_0.png" />
<p>The Thompson et al. model tends to be more complicated than the Sirko &amp;
Goodman model. We expect the temperature of the disk to decrease with
distance from the central BH, starting at values of <span class="math notranslate nohighlight">\(10^5\)</span> Kelvin
and dropping to lower temperature values than for the Sirko &amp; Goodman
case, depending on the mass of the central BH. The optical depth
<span class="math notranslate nohighlight">\(\tau\)</span> should look more complex than in the Sirko &amp; Goodman case.
The h/r ratio should stay below one, at least in the inner regions of
the disk. The vertical line shows where we have switched from the inner
regime to the outer regime.</p>
<p>A significant difference between the Thompson et al. model and the Sirko
and Goodman model is that the Thompson et al. model has a varying
accretion rate <span class="math notranslate nohighlight">\(\dot{M}\)</span>. To check that enough gas is being
accreted onto the central BH, one can also plot the accretion rate in
the Thompson et al. disk:</p>
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">tho</span><span class="o">.</span><span class="n">plot_mdot</span><span class="p">()</span>
</pre></div>
</div>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span> <span class="c1">### Checking Accretion Rates ###</span>
<span class="n">Mdot_Edd</span> <span class="o">=</span> <span class="mf">2.629148e+01</span> <span class="n">Msun</span> <span class="n">per</span> <span class="n">year</span>
<span class="n">Mdot_c</span> <span class="p">(</span><span class="n">r</span> <span class="o">=</span> <span class="n">Rout</span><span class="p">)</span> <span class="o">=</span> <span class="mf">9.606143e+03</span> <span class="n">Msun</span> <span class="n">per</span> <span class="n">year</span>
<span class="n">Mdot_out</span> <span class="o">=</span> <span class="mf">8.311237e+03</span> <span class="n">Msun</span> <span class="n">per</span> <span class="n">year</span>
<span class="n">Mdot</span> <span class="p">(</span><span class="n">r</span> <span class="o">=</span> <span class="n">Rin</span><span class="p">)</span> <span class="o">=</span> <span class="mf">4.815066e+00</span> <span class="n">Msun</span> <span class="n">per</span> <span class="n">year</span> <span class="o">=</span> <span class="mf">1.831417e-01</span> <span class="n">Mdot_Edd</span>
</pre></div>
</div>
<img alt="_images/output_22_1.png" src="_images/output_22_1.png" />
<p>We see that in this case, <span class="math notranslate nohighlight">\(\dot{M}_{\rm out}\)</span> is below the
critical accretion rate <span class="math notranslate nohighlight">\(\dot{M}_{\rm c}\)</span> at the outer boundary.
However, the accretion rate at the central BH is
<span class="math notranslate nohighlight">\(\approx 5 \, M_{\odot}/{\rm yr}\)</span>, which is deemed enough to fuel
a bright AGN.</p>
<p>One may also wish to save their results in a txt file.</p>
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="k">def</span> <span class="nf">save</span><span class="p">(</span><span class="n">obj</span><span class="p">,</span> <span class="n">filename</span><span class="p">):</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;Method to save key AGN model parameters to filename</span>

<span class="sd">    Parameters</span>
<span class="sd">    ----------</span>
<span class="sd">    obj: object</span>
<span class="sd">        Python object representing a solved AGN disk either from the Sirko &amp; Goodman model</span>
<span class="sd">        or from the Thompson model</span>

<span class="sd">    &quot;&quot;&quot;</span>
    <span class="n">pgas</span> <span class="o">=</span> <span class="n">sk</span><span class="o">.</span><span class="n">rho</span> <span class="o">*</span> <span class="n">sk</span><span class="o">.</span><span class="n">T</span> <span class="o">*</span> <span class="n">ct</span><span class="o">.</span><span class="n">Kb</span> <span class="o">/</span> <span class="n">ct</span><span class="o">.</span><span class="n">massU</span>
    <span class="n">prad</span> <span class="o">=</span> <span class="mi">4</span> <span class="o">*</span> <span class="n">ct</span><span class="o">.</span><span class="n">sigmaSB</span> <span class="o">*</span> <span class="p">(</span><span class="n">sk</span><span class="o">.</span><span class="n">T</span> <span class="o">**</span> <span class="mi">4</span><span class="p">)</span> <span class="o">/</span> <span class="p">(</span><span class="mi">3</span> <span class="o">*</span> <span class="n">ct</span><span class="o">.</span><span class="n">c</span><span class="p">)</span>
    <span class="n">cs</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">sqrt</span><span class="p">((</span><span class="n">pgas</span> <span class="o">+</span> <span class="n">prad</span><span class="p">)</span> <span class="o">/</span> <span class="p">(</span><span class="n">sk</span><span class="o">.</span><span class="n">rho</span><span class="p">))</span>
    <span class="n">omega</span> <span class="o">=</span> <span class="n">obj</span><span class="o">.</span><span class="n">Omega</span>
    <span class="n">rho</span> <span class="o">=</span> <span class="n">obj</span><span class="o">.</span><span class="n">rho</span>
    <span class="n">h</span> <span class="o">=</span> <span class="n">obj</span><span class="o">.</span><span class="n">h</span>
    <span class="n">T</span> <span class="o">=</span> <span class="n">obj</span><span class="o">.</span><span class="n">T</span>
    <span class="n">tauV</span> <span class="o">=</span> <span class="n">obj</span><span class="o">.</span><span class="n">tauV</span>
    <span class="n">Q</span> <span class="o">=</span> <span class="n">obj</span><span class="o">.</span><span class="n">Q</span>
    <span class="n">R</span> <span class="o">=</span> <span class="n">obj</span><span class="o">.</span><span class="n">R</span>
    <span class="k">if</span> <span class="nb">hasattr</span><span class="p">(</span><span class="n">obj</span><span class="p">,</span> <span class="s2">&quot;eta&quot;</span><span class="p">):</span>
        <span class="n">np</span><span class="o">.</span><span class="n">savetxt</span><span class="p">(</span><span class="n">filename</span><span class="p">,</span> <span class="n">np</span><span class="o">.</span><span class="n">vstack</span><span class="p">((</span><span class="n">R</span><span class="o">/</span><span class="n">ct</span><span class="o">.</span><span class="n">pc</span><span class="p">,</span> <span class="n">Omega</span><span class="p">,</span> <span class="n">T</span><span class="p">,</span> <span class="n">rho</span><span class="p">,</span> <span class="n">h</span><span class="p">,</span> <span class="n">obj</span><span class="o">.</span><span class="n">eta</span><span class="p">,</span> <span class="n">cs</span><span class="p">,</span> <span class="n">tauV</span><span class="p">,</span> <span class="n">Q</span><span class="p">))</span><span class="o">.</span><span class="n">T</span><span class="p">)</span>
    <span class="k">else</span><span class="p">:</span>
        <span class="n">np</span><span class="o">.</span><span class="n">savetxt</span><span class="p">(</span><span class="n">filename</span><span class="p">,</span> <span class="n">np</span><span class="o">.</span><span class="n">vstack</span><span class="p">((</span><span class="n">R</span><span class="o">/</span><span class="n">ct</span><span class="o">.</span><span class="n">pc</span><span class="p">,</span> <span class="n">Omega</span><span class="p">,</span> <span class="n">T</span><span class="p">,</span> <span class="n">rho</span><span class="p">,</span> <span class="n">h</span><span class="p">,</span> <span class="n">cs</span><span class="p">,</span> <span class="n">tauV</span><span class="p">,</span> <span class="n">Q</span><span class="p">))</span><span class="o">.</span><span class="n">T</span><span class="p">)</span>
</pre></div>
</div>
</section>
<section id="custom-opacity">
<h2>Custom Opacity<a class="headerlink" href="#custom-opacity" title="Link to this heading"></a></h2>
<p>Both SirkoAGN and ThompsonAGN can take in a custom opacity. The opacity
values have to be provided in a specific format for this to work. Below,
we generate some fake opacity values and show how to input them into the
models.</p>
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1">#First, generate or provide the temperature and density arrays over which the opacity grid</span>
<span class="c1">#is constructed. These must be in SI units. They should also ideally cover values of</span>
<span class="c1">#rho in the range [10^-15 g/m^3, 10^-4 g/m^3] and temperature in the range [10 K, 10^6 K].</span>
<span class="n">rho_arr</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">logspace</span><span class="p">(</span><span class="o">-</span><span class="mi">15</span><span class="p">,</span> <span class="o">-</span><span class="mi">4</span><span class="p">,</span> <span class="mi">10</span><span class="p">)</span>
<span class="n">temp_arr</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">logspace</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="n">np</span><span class="o">.</span><span class="n">log10</span><span class="p">(</span><span class="mi">999999</span><span class="p">),</span> <span class="mi">1001</span><span class="p">)</span>
<span class="c1">#generate kappa values in units of m^2/kg over this grid</span>
<span class="n">kappa_arr</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">ones</span><span class="p">((</span><span class="nb">len</span><span class="p">(</span><span class="n">rho_arr</span><span class="p">),</span> <span class="nb">len</span><span class="p">(</span><span class="n">temp_arr</span><span class="p">)))</span><span class="o">*</span><span class="mf">0.6</span> <span class="c1">#simple example where opacity is 0.6 m^2/kg for all rho and T values</span>

<span class="nb">print</span><span class="p">(</span><span class="n">kappa_arr</span><span class="o">.</span><span class="n">shape</span><span class="p">)</span>
<span class="c1">#input the following into either models:</span>
<span class="n">opacity</span> <span class="o">=</span> <span class="p">(</span><span class="n">kappa_arr</span><span class="p">,</span> <span class="n">rho_arr</span><span class="p">,</span> <span class="n">temp_arr</span><span class="p">)</span>
</pre></div>
</div>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="p">(</span><span class="mi">10</span><span class="p">,</span> <span class="mi">1001</span><span class="p">)</span>
</pre></div>
</div>
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="o">%%capture</span>
<span class="c1">#the Sirko &amp; Goodman model with this custom opacity</span>
<span class="n">sk_co</span> <span class="o">=</span> <span class="n">Sirko</span><span class="o">.</span><span class="n">SirkoAGN</span><span class="p">(</span><span class="n">opacity</span> <span class="o">=</span> <span class="n">opacity</span><span class="p">)</span>
<span class="n">sk_co</span><span class="o">.</span><span class="n">solve_disk</span><span class="p">()</span> <span class="p">;</span>

<span class="c1">#the Thompson et al. model with this custom opacity</span>
<span class="n">tho_co</span> <span class="o">=</span> <span class="n">Thompson</span><span class="o">.</span><span class="n">ThompsonAGN</span><span class="p">(</span><span class="n">opacity</span> <span class="o">=</span> <span class="n">opacity</span><span class="p">)</span>
<span class="n">tho_co</span><span class="o">.</span><span class="n">solve_disk</span><span class="p">()</span> <span class="p">;</span>
</pre></div>
</div>
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1">#As before, we can check the custom opacity models worked by quickly plotting the key parameters:</span>
<span class="n">sk_co</span><span class="o">.</span><span class="n">plot</span><span class="p">()</span>
<span class="n">tho_co</span><span class="o">.</span><span class="n">plot</span><span class="p">()</span>
</pre></div>
</div>
<img alt="_images/output_30_0.png" src="_images/output_30_0.png" />
<img alt="_images/output_30_1.png" src="_images/output_30_1.png" />
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1">#We can also directly check what the opacity values look like for this disk:</span>
<span class="n">plt</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">log10</span><span class="p">(</span><span class="n">sk_co</span><span class="o">.</span><span class="n">R</span><span class="p">),</span> <span class="n">np</span><span class="o">.</span><span class="n">log10</span><span class="p">(</span><span class="n">sk_co</span><span class="o">.</span><span class="n">kappa</span><span class="p">),</span> <span class="n">label</span> <span class="o">=</span> <span class="s2">&quot;Sirko &amp; Goodman&quot;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">log10</span><span class="p">(</span><span class="n">tho_co</span><span class="o">.</span><span class="n">R</span><span class="p">),</span> <span class="n">np</span><span class="o">.</span><span class="n">log10</span><span class="p">(</span><span class="n">tho_co</span><span class="o">.</span><span class="n">kappa</span><span class="p">),</span> <span class="s2">&quot;--&quot;</span><span class="p">,</span> <span class="n">label</span> <span class="o">=</span> <span class="s2">&quot;Thompson et al&quot;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">xlim</span><span class="p">((</span><span class="mi">12</span><span class="p">,</span> <span class="mi">19</span><span class="p">))</span>
<span class="n">plt</span><span class="o">.</span><span class="n">ylim</span><span class="p">((</span><span class="o">-</span><span class="mf">0.224</span><span class="p">,</span> <span class="o">-</span><span class="mf">0.22</span><span class="p">))</span>
<span class="n">plt</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>
</pre></div>
</div>
<img alt="_images/output_31_0.png" src="_images/output_31_0.png" />
<p>Unsurprisingly, we get a flat line for our <span class="math notranslate nohighlight">\(\kappa\)</span> values.</p>
</section>
<section id="luminosities">
<h2>Luminosities<a class="headerlink" href="#luminosities" title="Link to this heading"></a></h2>
<p>To calculate the bolometric luminosity of the AGN disks, we use Eq. 47
from Thompson et al. 2005:</p>
<p><a href="#id1"><span class="problematic" id="id2">:raw-latex:`\begin{equation}
L_{\rm disk} = \int_{\lambda_{\rm min}}^{\lambda_{\rm max}} L_{\lambda} \mathrm{d}\lambda = 2 \pi h c^2\int_{\lambda_{\rm min}}^{\lambda_{\rm max}} \frac{1}{\lambda^4} \mathrm{d}\lambda \int_{r_{\rm min}}^{r_{\rm out}} \frac{2 \pi r \, \mathrm{d}r}{\exp{ \{ \frac{h c}{\lambda T_{\rm eff}  }\} -1}}
\end{equation}`</span></a></p>
<p>We approximate these integrals as sums:</p>
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="k">def</span> <span class="nf">calculate_lum_sum</span><span class="p">(</span><span class="n">Teffarr</span><span class="p">,</span> <span class="n">wavelengthmin</span><span class="p">,</span> <span class="n">wavelengthmax</span><span class="p">,</span> <span class="n">rarr</span><span class="p">,</span> <span class="n">deltar</span><span class="p">):</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;Calculates luminosity of AGN disk using sums</span>

<span class="sd">    Parameters</span>
<span class="sd">    ----------</span>
<span class="sd">    Teffarr: array</span>
<span class="sd">        Array of effective temperature values calculated for each value in rarr in K</span>
<span class="sd">    wavelengthmin: float</span>
<span class="sd">        Minimum wavelength value in m</span>
<span class="sd">    wavelengthmax: float</span>
<span class="sd">        Maximum wavelength value in m</span>
<span class="sd">    rarr: array</span>
<span class="sd">        Array of distance from central BH values in m</span>

<span class="sd">    Results</span>
<span class="sd">    -------</span>
<span class="sd">    I: float</span>
<span class="sd">        Integrated value of luminosities over given wavelength range in Watts</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="n">lambarredge</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">logspace</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">log10</span><span class="p">(</span><span class="n">wavelengthmin</span><span class="p">),</span> <span class="n">np</span><span class="o">.</span><span class="n">log10</span><span class="p">(</span><span class="n">wavelengthmax</span><span class="p">),</span> <span class="mi">1000</span><span class="p">)</span>
    <span class="n">deltalambda</span> <span class="o">=</span> <span class="n">lambarredge</span><span class="p">[</span><span class="mi">1</span><span class="p">:]</span> <span class="o">-</span> <span class="n">lambarredge</span><span class="p">[:</span><span class="mi">1</span><span class="p">]</span>
    <span class="n">lambarr</span> <span class="o">=</span> <span class="p">(</span><span class="n">lambarredge</span><span class="p">[:</span><span class="o">-</span><span class="mi">1</span><span class="p">]</span> <span class="o">+</span> <span class="n">lambarredge</span><span class="p">[</span><span class="mi">1</span><span class="p">:])</span><span class="o">/</span><span class="mi">2</span>

    <span class="n">r_int_arr</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">zeros</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">lambarr</span><span class="p">))</span>
    <span class="k">for</span> <span class="n">il</span><span class="p">,</span> <span class="n">lamb</span> <span class="ow">in</span> <span class="nb">enumerate</span><span class="p">(</span><span class="n">lambarr</span><span class="p">):</span>
        <span class="c1">#the exponential factor in the integral. If it is too large, there is an overflow error, but these values give an integral value of zero so we can safely ignore their values.</span>
        <span class="n">exp_factor</span> <span class="o">=</span> <span class="n">ct</span><span class="o">.</span><span class="n">h</span> <span class="o">*</span> <span class="n">ct</span><span class="o">.</span><span class="n">c</span> <span class="o">/</span> <span class="p">(</span><span class="n">lamb</span> <span class="o">*</span> <span class="n">ct</span><span class="o">.</span><span class="n">Kb</span> <span class="o">*</span> <span class="n">Teffarr</span><span class="p">)</span>
        <span class="n">I_sum</span> <span class="o">=</span> <span class="nb">sum</span><span class="p">(</span><span class="mi">2</span><span class="o">*</span><span class="n">np</span><span class="o">.</span><span class="n">pi</span><span class="o">*</span><span class="n">rarr</span><span class="p">[</span><span class="n">exp_factor</span> <span class="o">&lt;</span> <span class="mi">40</span><span class="p">]</span><span class="o">*</span><span class="n">deltar</span><span class="p">[</span><span class="n">exp_factor</span> <span class="o">&lt;</span> <span class="mi">40</span><span class="p">]</span><span class="o">/</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">exp</span><span class="p">(</span><span class="n">exp_factor</span><span class="p">[</span><span class="n">exp_factor</span> <span class="o">&lt;</span> <span class="mi">40</span><span class="p">]))</span> <span class="o">-</span> <span class="mi">1</span><span class="p">)</span>
        <span class="c1">#calculate integral in r</span>
        <span class="n">r_int_arr</span><span class="p">[</span><span class="n">il</span><span class="p">]</span> <span class="o">+=</span> <span class="n">I_sum</span>
    <span class="c1">#calculate full integral</span>
    <span class="n">I</span> <span class="o">=</span> <span class="nb">sum</span><span class="p">(</span><span class="mi">2</span><span class="o">*</span><span class="n">np</span><span class="o">.</span><span class="n">pi</span><span class="o">*</span><span class="n">ct</span><span class="o">.</span><span class="n">h</span><span class="o">*</span><span class="n">ct</span><span class="o">.</span><span class="n">c</span><span class="o">*</span><span class="n">ct</span><span class="o">.</span><span class="n">c</span><span class="o">*</span><span class="n">deltalambda</span><span class="o">*</span><span class="n">r_int_arr</span><span class="o">/</span><span class="p">(</span><span class="n">lambarr</span><span class="o">*</span><span class="n">lambarr</span><span class="o">*</span><span class="n">lambarr</span><span class="o">*</span><span class="n">lambarr</span><span class="p">))</span>
    <span class="k">return</span> <span class="n">I</span>
</pre></div>
</div>
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="nb">print</span><span class="p">(</span><span class="s2">&quot;Luminosity of Thompson et al. 2005 disk: &quot;</span><span class="p">,</span> <span class="n">calculate_lum_sum</span><span class="p">(</span><span class="n">tho</span><span class="o">.</span><span class="n">Teff4</span><span class="o">**</span><span class="mf">0.25</span><span class="p">,</span> <span class="mf">1e-8</span><span class="p">,</span> <span class="mf">1e-3</span><span class="p">,</span> <span class="n">tho</span><span class="o">.</span><span class="n">R</span><span class="p">,</span> <span class="n">tho</span><span class="o">.</span><span class="n">deltaR</span><span class="p">)</span><span class="o">/</span><span class="n">ct</span><span class="o">.</span><span class="n">LSun</span><span class="p">,</span> <span class="s2">&quot; solar luminosities&quot;</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="s2">&quot;Luminosity of Sirko &amp; Goodman 2003 disk: &quot;</span><span class="p">,</span> <span class="n">calculate_lum_sum</span><span class="p">(</span><span class="n">sk</span><span class="o">.</span><span class="n">Teff4</span><span class="o">**</span><span class="mf">0.25</span><span class="p">,</span> <span class="mf">1e-8</span><span class="p">,</span> <span class="mf">1e-3</span><span class="p">,</span> <span class="n">sk</span><span class="o">.</span><span class="n">R</span><span class="p">,</span> <span class="n">sk</span><span class="o">.</span><span class="n">deltaR</span><span class="p">)</span><span class="o">/</span><span class="n">ct</span><span class="o">.</span><span class="n">LSun</span><span class="p">,</span> <span class="s2">&quot; solar luminosities&quot;</span><span class="p">)</span>
</pre></div>
</div>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">Luminosity</span> <span class="n">of</span> <span class="n">Thompson</span> <span class="n">et</span> <span class="n">al</span><span class="o">.</span> <span class="mi">2005</span> <span class="n">disk</span><span class="p">:</span>  <span class="mf">177303419977.49695</span>  <span class="n">solar</span> <span class="n">luminosities</span>
<span class="n">Luminosity</span> <span class="n">of</span> <span class="n">Sirko</span> <span class="o">&amp;</span> <span class="n">Goodman</span> <span class="mi">2003</span> <span class="n">disk</span><span class="p">:</span>  <span class="mf">1054693353944.121</span>  <span class="n">solar</span> <span class="n">luminosities</span>
</pre></div>
</div>
</section>
<section id="use-case-migration-torques">
<h2>Use Case: Migration Torques<a class="headerlink" href="#use-case-migration-torques" title="Link to this heading"></a></h2>
<p>Below, we provide the code for a more in depth use case of pagn, looking
at the migration torques a 50 M<span class="math notranslate nohighlight">\(_\odot\)</span> BH in an AGN would
experience while orbiting a central BH. We use the equations from
<a class="reference external" href="https://arxiv.org/pdf/2307.07546.pdf">Grishin et al. 2023</a></p>
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="kn">from</span> <span class="nn">scipy.interpolate</span> <span class="kn">import</span> <span class="n">UnivariateSpline</span>
<span class="kn">from</span> <span class="nn">opacities</span> <span class="kn">import</span> <span class="n">electron_scattering_opacity</span>
<span class="kn">import</span> <span class="nn">matplotlib.lines</span> <span class="k">as</span> <span class="nn">mlines</span>
</pre></div>
</div>
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="k">def</span> <span class="nf">gamma_0</span><span class="p">(</span><span class="n">q</span><span class="p">,</span> <span class="n">hr</span><span class="p">,</span> <span class="n">Sigma</span><span class="p">,</span> <span class="n">r</span><span class="p">,</span> <span class="n">Omega</span><span class="p">):</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Method to find the normalization torque</span>

<span class="sd">    Parameters</span>
<span class="sd">    ----------</span>
<span class="sd">    q: float/array</span>
<span class="sd">        Float or array representing the mass ratio between the migrator and the central BH.</span>
<span class="sd">    hr: float/array</span>
<span class="sd">        Float or array representing the disk height to distance from central BH ratio.</span>
<span class="sd">    Sigma: float/array</span>
<span class="sd">        Float or array representing the disk surface density in kg/m^2</span>
<span class="sd">    r: float/array</span>
<span class="sd">        Float or array representing the distance from the central BH in m</span>
<span class="sd">    Omega: float/array</span>
<span class="sd">        Float or array representing the angular velocity at the migrator position in SI units.</span>

<span class="sd">    Returns</span>
<span class="sd">    -------</span>
<span class="sd">    gamma_0: float/array</span>
<span class="sd">        Float or array representing the single-arm migration torque on the migrator in kg m^2/ s^2.</span>

<span class="sd">    &quot;&quot;&quot;</span>
    <span class="n">gamma_0</span> <span class="o">=</span> <span class="n">q</span><span class="o">*</span><span class="n">q</span><span class="o">*</span><span class="n">Sigma</span><span class="o">*</span><span class="n">r</span><span class="o">*</span><span class="n">r</span><span class="o">*</span><span class="n">r</span><span class="o">*</span><span class="n">r</span><span class="o">*</span><span class="n">Omega</span><span class="o">*</span><span class="n">Omega</span><span class="o">/</span><span class="p">(</span><span class="n">hr</span><span class="o">*</span><span class="n">hr</span><span class="p">)</span>
    <span class="k">return</span> <span class="n">gamma_0</span>


<span class="k">def</span> <span class="nf">gamma_iso</span><span class="p">(</span><span class="n">dSigmadR</span><span class="p">,</span> <span class="n">dTdR</span><span class="p">):</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Method to find the locally isothermal torque.</span>

<span class="sd">    Parameters</span>
<span class="sd">    ----------</span>
<span class="sd">    dSigmadR: float/array</span>
<span class="sd">        Discrete array representing the log surface density gradient in the disk.</span>
<span class="sd">    dTdR: float/array</span>
<span class="sd">        Discrete array representing the log thermal gradient in the disk.</span>

<span class="sd">    Returns</span>
<span class="sd">    -------</span>
<span class="sd">    gamma_iso: float/array</span>
<span class="sd">        Float or array representing the locally isothermal torque on the migrator in kg m^2/ s^2.</span>

<span class="sd">    &quot;&quot;&quot;</span>
    <span class="n">alpha</span> <span class="o">=</span> <span class="o">-</span> <span class="n">dSigmadR</span>
    <span class="n">beta</span> <span class="o">=</span> <span class="o">-</span> <span class="n">dTdR</span>
    <span class="n">gamma_iso</span> <span class="o">=</span> <span class="o">-</span> <span class="mf">0.85</span> <span class="o">-</span> <span class="n">alpha</span> <span class="o">-</span> <span class="mf">0.9</span><span class="o">*</span><span class="n">beta</span>
    <span class="k">return</span> <span class="n">gamma_iso</span>


<span class="k">def</span> <span class="nf">gamma_ad</span><span class="p">(</span><span class="n">dSigmadR</span><span class="p">,</span> <span class="n">dTdR</span><span class="p">):</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Method to find the adiabatic torque.</span>

<span class="sd">    Parameters</span>
<span class="sd">    ----------</span>
<span class="sd">    dSigmadR: float/array</span>
<span class="sd">        Discrete array representing the log surface density gradient in the disk.</span>
<span class="sd">    dTdR: float/array</span>
<span class="sd">        Discrete array representing the log thermal gradient in the disk.</span>

<span class="sd">    Returns</span>
<span class="sd">    -------</span>
<span class="sd">    gamma_ad: float/array</span>
<span class="sd">        Float or array representing the adabiatic torque on the migrator in kg m^2/ s^2.</span>

<span class="sd">    &quot;&quot;&quot;</span>
    <span class="n">alpha</span> <span class="o">=</span> <span class="o">-</span> <span class="n">dSigmadR</span>
    <span class="n">beta</span> <span class="o">=</span> <span class="o">-</span> <span class="n">dTdR</span>
    <span class="n">gamma</span> <span class="o">=</span> <span class="mi">5</span><span class="o">/</span><span class="mi">3</span>
    <span class="n">xi</span> <span class="o">=</span> <span class="n">beta</span> <span class="o">-</span> <span class="p">(</span><span class="n">gamma</span> <span class="o">-</span> <span class="mi">1</span><span class="p">)</span><span class="o">*</span><span class="n">alpha</span>
    <span class="n">gamma_ad</span> <span class="o">=</span> <span class="o">-</span> <span class="mf">0.85</span> <span class="o">-</span> <span class="n">alpha</span> <span class="o">-</span> <span class="mf">1.7</span><span class="o">*</span><span class="n">beta</span> <span class="o">+</span> <span class="mf">7.9</span><span class="o">*</span><span class="n">xi</span><span class="o">/</span><span class="n">gamma</span>
    <span class="k">return</span> <span class="n">gamma_ad</span>


<span class="k">def</span> <span class="nf">dSigmadR</span><span class="p">(</span><span class="n">obj</span><span class="p">):</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Method that interpolates the surface density gradient of an AGN disk object.</span>

<span class="sd">    Parameters</span>
<span class="sd">    ----------</span>
<span class="sd">    obj: object</span>
<span class="sd">        Either a SirkoAGN or ThompsonAGN object representing the AGN disk being considered.</span>

<span class="sd">    Returns</span>
<span class="sd">    -------</span>
<span class="sd">    dSigmadR: float/array</span>
<span class="sd">        Discrete array of the log surface density gradient.</span>

<span class="sd">    &quot;&quot;&quot;</span>
    <span class="n">Sigma</span> <span class="o">=</span> <span class="mi">2</span><span class="o">*</span><span class="n">obj</span><span class="o">.</span><span class="n">rho</span><span class="o">*</span><span class="n">obj</span><span class="o">.</span><span class="n">h</span> <span class="c1"># descrete</span>
    <span class="n">rlog10</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">log10</span><span class="p">(</span><span class="n">obj</span><span class="o">.</span><span class="n">R</span><span class="p">)</span>  <span class="c1"># descrete</span>
    <span class="n">Sigmalog10</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">log10</span><span class="p">(</span><span class="n">Sigma</span><span class="p">)</span>  <span class="c1"># descrete</span>
    <span class="n">Sigmalog10_spline</span> <span class="o">=</span> <span class="n">UnivariateSpline</span><span class="p">(</span><span class="n">rlog10</span><span class="p">,</span> <span class="n">Sigmalog10</span><span class="p">,</span> <span class="n">k</span><span class="o">=</span><span class="mi">3</span><span class="p">,</span> <span class="n">s</span><span class="o">=</span><span class="mf">0.005</span><span class="p">,</span> <span class="n">ext</span><span class="o">=</span><span class="mi">0</span><span class="p">)</span>  <span class="c1"># need scipy ver 1.10.0</span>
    <span class="n">dSigmadR_spline</span> <span class="o">=</span>  <span class="n">Sigmalog10_spline</span><span class="o">.</span><span class="n">derivative</span><span class="p">()</span>
    <span class="n">dSigmadR</span> <span class="o">=</span> <span class="n">dSigmadR_spline</span><span class="p">(</span><span class="n">rlog10</span><span class="p">)</span>
    <span class="k">return</span> <span class="n">dSigmadR</span>


<span class="k">def</span> <span class="nf">dTdR</span><span class="p">(</span><span class="n">obj</span><span class="p">):</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Method that interpolates the thermal gradient of an AGN disk object.</span>

<span class="sd">    Parameters</span>
<span class="sd">    ----------</span>
<span class="sd">    obj: object</span>
<span class="sd">        Either a SirkoAGN or ThompsonAGN object representing the AGN disk being considered.</span>

<span class="sd">    Returns</span>
<span class="sd">    -------</span>
<span class="sd">    dTdR: float/array</span>
<span class="sd">        Discrete array of the log thermal gradient.</span>

<span class="sd">    &quot;&quot;&quot;</span>
    <span class="n">rlog10</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">log10</span><span class="p">(</span><span class="n">obj</span><span class="o">.</span><span class="n">R</span><span class="p">)</span>  <span class="c1"># descrete</span>
    <span class="n">Tlog10</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">log10</span><span class="p">(</span><span class="n">obj</span><span class="o">.</span><span class="n">T</span><span class="p">)</span>  <span class="c1"># descrete</span>
    <span class="n">Tlog10_spline</span> <span class="o">=</span> <span class="n">UnivariateSpline</span><span class="p">(</span><span class="n">rlog10</span><span class="p">,</span> <span class="n">Tlog10</span><span class="p">,</span> <span class="n">k</span><span class="o">=</span><span class="mi">3</span><span class="p">,</span> <span class="n">s</span><span class="o">=</span><span class="mf">0.005</span><span class="p">,</span> <span class="n">ext</span><span class="o">=</span><span class="mi">0</span><span class="p">)</span>  <span class="c1"># need scipy ver 1.10.0</span>
    <span class="n">dTdR_spline</span> <span class="o">=</span> <span class="n">Tlog10_spline</span><span class="o">.</span><span class="n">derivative</span><span class="p">()</span>
    <span class="n">dTdR</span> <span class="o">=</span> <span class="n">dTdR_spline</span><span class="p">(</span><span class="n">rlog10</span><span class="p">)</span>
    <span class="k">return</span> <span class="n">dTdR</span>


<span class="k">def</span> <span class="nf">dPdR</span><span class="p">(</span><span class="n">obj</span><span class="p">):</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Method that interpolates the total pressure gradient of an AGN disk object.</span>

<span class="sd">    Parameters</span>
<span class="sd">    ----------</span>
<span class="sd">    obj: object</span>
<span class="sd">        Either a SirkoAGN or ThompsonAGN object representing the AGN disk being considered.</span>

<span class="sd">    Returns</span>
<span class="sd">    -------</span>
<span class="sd">    dPdR: float/array</span>
<span class="sd">        Discrete array of the log total pressure gradient.</span>

<span class="sd">    &quot;&quot;&quot;</span>
    <span class="n">rlog10</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">log10</span><span class="p">(</span><span class="n">obj</span><span class="o">.</span><span class="n">R</span><span class="p">)</span>  <span class="c1"># descrete</span>
    <span class="n">pgas</span> <span class="o">=</span> <span class="n">obj</span><span class="o">.</span><span class="n">rho</span> <span class="o">*</span> <span class="n">obj</span><span class="o">.</span><span class="n">T</span> <span class="o">*</span> <span class="n">ct</span><span class="o">.</span><span class="n">Kb</span> <span class="o">/</span> <span class="n">ct</span><span class="o">.</span><span class="n">massU</span>
    <span class="n">prad</span> <span class="o">=</span> <span class="n">obj</span><span class="o">.</span><span class="n">tauV</span><span class="o">*</span><span class="n">ct</span><span class="o">.</span><span class="n">sigmaSB</span><span class="o">*</span><span class="n">obj</span><span class="o">.</span><span class="n">Teff4</span><span class="o">/</span><span class="p">(</span><span class="mi">2</span><span class="o">*</span><span class="n">ct</span><span class="o">.</span><span class="n">c</span><span class="p">)</span>
    <span class="n">ptot</span> <span class="o">=</span> <span class="n">pgas</span> <span class="o">+</span> <span class="n">prad</span>
    <span class="n">Plog10</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">log10</span><span class="p">(</span><span class="n">ptot</span><span class="p">)</span>  <span class="c1"># descrete</span>
    <span class="n">Plog10_spline</span> <span class="o">=</span> <span class="n">UnivariateSpline</span><span class="p">(</span><span class="n">rlog10</span><span class="p">,</span> <span class="n">Plog10</span><span class="p">,</span> <span class="n">k</span><span class="o">=</span><span class="mi">3</span><span class="p">,</span> <span class="n">s</span><span class="o">=</span><span class="mf">0.005</span><span class="p">,</span> <span class="n">ext</span><span class="o">=</span><span class="mi">0</span><span class="p">)</span>  <span class="c1"># need scipy ver 1.10.0</span>
    <span class="n">dPdR_spline</span> <span class="o">=</span> <span class="n">Plog10_spline</span><span class="o">.</span><span class="n">derivative</span><span class="p">()</span>
    <span class="n">dPdR</span> <span class="o">=</span> <span class="n">dPdR_spline</span><span class="p">(</span><span class="n">rlog10</span><span class="p">)</span>
    <span class="k">return</span> <span class="n">dPdR</span>


<span class="k">def</span> <span class="nf">CI_p10</span><span class="p">(</span><span class="n">dSigmadR</span><span class="p">,</span> <span class="n">dTdR</span><span class="p">):</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Method to calculate torque coefficient for the Paardekooper et al. 2010 values.</span>

<span class="sd">    Parameters</span>
<span class="sd">    ----------</span>
<span class="sd">    dSigmadR: float/array</span>
<span class="sd">        Discrete array representing the log surface density gradient in the disk.</span>
<span class="sd">    dTdR: float/array</span>
<span class="sd">        Discrete array representing the log thermal gradient in the disk.</span>

<span class="sd">    Returns</span>
<span class="sd">    -------</span>
<span class="sd">    cI: float/array</span>
<span class="sd">        Paardekooper et al. 2010 migration torque coefficient</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="n">cI</span> <span class="o">=</span> <span class="o">-</span><span class="mf">0.85</span> <span class="o">+</span> <span class="mf">0.9</span><span class="o">*</span><span class="n">dTdR</span> <span class="o">+</span> <span class="n">dSigmadR</span>
    <span class="k">return</span> <span class="n">cI</span>


<span class="k">def</span> <span class="nf">CI_jm17_tot</span><span class="p">(</span><span class="n">dSigmadR</span><span class="p">,</span> <span class="n">dTdR</span><span class="p">,</span> <span class="n">gamma</span><span class="p">,</span> <span class="n">obj</span><span class="p">):</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Method to calculate torque coefficient for the Jiménez and Masset 2017 values.</span>

<span class="sd">    Parameters</span>
<span class="sd">    ----------</span>
<span class="sd">    dSigmadR: float/array</span>
<span class="sd">        Discrete array representing the log surface density gradient in the disk.</span>
<span class="sd">    dTdR: float/array</span>
<span class="sd">        Discrete array representing the log thermal gradient in the disk.</span>
<span class="sd">    gamma: float</span>
<span class="sd">        Adiabatic index</span>
<span class="sd">    obj: object</span>
<span class="sd">        Either a SirkoAGN or ThompsonAGN object representing the AGN disk being considered.</span>


<span class="sd">    Returns</span>
<span class="sd">    -------</span>
<span class="sd">    cI: float/array</span>
<span class="sd">        Jiménez and Masset 2017 migration torque coefficient</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="n">cL</span> <span class="o">=</span> <span class="n">CL</span><span class="p">(</span><span class="n">dSigmadR</span><span class="p">,</span> <span class="n">dTdR</span><span class="p">,</span> <span class="n">gamma</span><span class="p">,</span> <span class="n">obj</span><span class="p">)</span>
    <span class="n">cI</span> <span class="o">=</span> <span class="n">cL</span> <span class="o">+</span> <span class="p">(</span><span class="mf">0.46</span> <span class="o">+</span> <span class="mf">0.96</span><span class="o">*</span><span class="n">dSigmadR</span> <span class="o">-</span> <span class="mf">1.8</span><span class="o">*</span><span class="n">dTdR</span><span class="p">)</span><span class="o">/</span><span class="n">gamma</span>
    <span class="k">return</span> <span class="n">cI</span>


<span class="k">def</span> <span class="nf">CI_jm17_iso</span><span class="p">(</span><span class="n">dSigmadR</span><span class="p">,</span> <span class="n">dTdR</span><span class="p">):</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Method to calculate the locally isothermal torque coefficient for the Jiménez and Masset 2017 values.</span>

<span class="sd">    Parameters</span>
<span class="sd">    ----------</span>
<span class="sd">    dSigmadR: float/array</span>
<span class="sd">        Discrete array representing the log surface density gradient in the disk.</span>
<span class="sd">    dTdR: float/array</span>
<span class="sd">        Discrete array representing the log thermal gradient in the disk.</span>

<span class="sd">    Returns</span>
<span class="sd">    -------</span>
<span class="sd">    cI: float/array</span>
<span class="sd">        Jiménez and Masset 2017 migration locally isothermal torque coefficient</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="n">cI</span> <span class="o">=</span> <span class="o">-</span><span class="mf">1.36</span> <span class="o">+</span> <span class="mf">0.54</span><span class="o">*</span><span class="n">dSigmadR</span> <span class="o">+</span> <span class="mf">0.5</span><span class="o">*</span><span class="n">dTdR</span>
    <span class="k">return</span> <span class="n">cI</span>


<span class="k">def</span> <span class="nf">CL</span><span class="p">(</span><span class="n">dSigmadR</span><span class="p">,</span> <span class="n">dTdR</span><span class="p">,</span> <span class="n">gamma</span><span class="p">,</span> <span class="n">obj</span><span class="p">):</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Method to calculate the Lindlblad torque for the Jiménez and Masset 2017 values.</span>

<span class="sd">    Parameters</span>
<span class="sd">    ----------</span>
<span class="sd">    dSigmadR: float/array</span>
<span class="sd">        Discrete array representing the log surface density gradient in the disk.</span>
<span class="sd">    dTdR: float/array</span>
<span class="sd">        Discrete array representing the log thermal gradient in the disk.</span>
<span class="sd">    gamma: float</span>
<span class="sd">        Adiabatic index</span>
<span class="sd">    obj: object</span>
<span class="sd">        Either a SirkoAGN or ThompsonAGN object representing the AGN disk being considered.</span>


<span class="sd">    Returns</span>
<span class="sd">    -------</span>
<span class="sd">    cL: float/array</span>
<span class="sd">        Jiménez and Masset 2017 Lindblad torque coefficient</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="n">xi</span> <span class="o">=</span> <span class="mi">16</span><span class="o">*</span><span class="n">gamma</span><span class="o">*</span><span class="p">(</span><span class="n">gamma</span> <span class="o">-</span> <span class="mi">1</span><span class="p">)</span><span class="o">*</span><span class="n">ct</span><span class="o">.</span><span class="n">sigmaSB</span><span class="o">*</span><span class="p">(</span><span class="n">obj</span><span class="o">.</span><span class="n">T</span><span class="o">*</span><span class="n">obj</span><span class="o">.</span><span class="n">T</span><span class="o">*</span><span class="n">obj</span><span class="o">.</span><span class="n">T</span><span class="o">*</span><span class="n">obj</span><span class="o">.</span><span class="n">T</span><span class="p">)</span>\
         <span class="o">/</span><span class="p">(</span><span class="mi">3</span><span class="o">*</span><span class="n">obj</span><span class="o">.</span><span class="n">kappa</span><span class="o">*</span><span class="n">obj</span><span class="o">.</span><span class="n">rho</span><span class="o">*</span><span class="n">obj</span><span class="o">.</span><span class="n">rho</span><span class="o">*</span><span class="n">obj</span><span class="o">.</span><span class="n">h</span><span class="o">*</span><span class="n">obj</span><span class="o">.</span><span class="n">h</span><span class="o">*</span><span class="n">obj</span><span class="o">.</span><span class="n">Omega</span><span class="o">*</span><span class="n">obj</span><span class="o">.</span><span class="n">Omega</span><span class="p">)</span>
    <span class="n">x2_sqrt</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">sqrt</span><span class="p">(</span><span class="n">xi</span><span class="o">/</span><span class="p">(</span><span class="mi">2</span><span class="o">*</span><span class="n">obj</span><span class="o">.</span><span class="n">h</span><span class="o">*</span><span class="n">obj</span><span class="o">.</span><span class="n">h</span><span class="o">*</span><span class="n">obj</span><span class="o">.</span><span class="n">Omega</span><span class="p">))</span>
    <span class="n">fgamma</span> <span class="o">=</span> <span class="p">(</span><span class="n">x2_sqrt</span> <span class="o">+</span> <span class="mi">1</span><span class="o">/</span><span class="n">gamma</span><span class="p">)</span><span class="o">/</span><span class="p">(</span><span class="n">x2_sqrt</span><span class="o">+</span><span class="mi">1</span><span class="p">)</span>
    <span class="n">cL</span> <span class="o">=</span> <span class="p">(</span><span class="o">-</span><span class="mf">2.34</span> <span class="o">-</span> <span class="mf">0.1</span><span class="o">*</span><span class="n">dSigmadR</span> <span class="o">+</span> <span class="mf">1.5</span><span class="o">*</span><span class="n">dTdR</span><span class="p">)</span><span class="o">*</span><span class="n">fgamma</span>
    <span class="k">return</span> <span class="n">cL</span>


<span class="k">def</span> <span class="nf">gamma_thermal</span><span class="p">(</span><span class="n">gamma</span><span class="p">,</span> <span class="n">obj</span><span class="p">,</span> <span class="n">q</span><span class="p">):</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Method to calculate the thermal torque from the Masset 2017 equations.</span>

<span class="sd">    Parameters</span>
<span class="sd">    ----------</span>
<span class="sd">    gamma: float</span>
<span class="sd">        Adiabatic index</span>
<span class="sd">    obj: object</span>
<span class="sd">        Either a SirkoAGN or ThompsonAGN object representing the AGN disk being considered.</span>
<span class="sd">    q: float/array</span>
<span class="sd">        Float or array representing the mass ratio between the migrator and the central BH.</span>

<span class="sd">    Returns</span>
<span class="sd">    -------</span>
<span class="sd">    g_thermal: float/array</span>
<span class="sd">        Masset 2017 migration total thermal torque.</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="n">xi</span> <span class="o">=</span> <span class="mi">16</span> <span class="o">*</span> <span class="n">gamma</span> <span class="o">*</span> <span class="p">(</span><span class="n">gamma</span> <span class="o">-</span> <span class="mi">1</span><span class="p">)</span> <span class="o">*</span> <span class="n">ct</span><span class="o">.</span><span class="n">sigmaSB</span> <span class="o">*</span> <span class="p">(</span><span class="n">obj</span><span class="o">.</span><span class="n">T</span> <span class="o">*</span> <span class="n">obj</span><span class="o">.</span><span class="n">T</span> <span class="o">*</span> <span class="n">obj</span><span class="o">.</span><span class="n">T</span> <span class="o">*</span> <span class="n">obj</span><span class="o">.</span><span class="n">T</span><span class="p">)</span> \
         <span class="o">/</span> <span class="p">(</span><span class="mi">3</span> <span class="o">*</span> <span class="n">obj</span><span class="o">.</span><span class="n">kappa</span> <span class="o">*</span> <span class="n">obj</span><span class="o">.</span><span class="n">rho</span> <span class="o">*</span> <span class="n">obj</span><span class="o">.</span><span class="n">rho</span> <span class="o">*</span> <span class="n">obj</span><span class="o">.</span><span class="n">h</span> <span class="o">*</span> <span class="n">obj</span><span class="o">.</span><span class="n">h</span> <span class="o">*</span> <span class="n">obj</span><span class="o">.</span><span class="n">Omega</span> <span class="o">*</span> <span class="n">obj</span><span class="o">.</span><span class="n">Omega</span><span class="p">)</span>
    <span class="n">mbh</span> <span class="o">=</span> <span class="n">obj</span><span class="o">.</span><span class="n">Mbh</span><span class="o">*</span><span class="n">q</span>
    <span class="n">Lc</span> <span class="o">=</span> <span class="mi">4</span><span class="o">*</span><span class="n">np</span><span class="o">.</span><span class="n">pi</span><span class="o">*</span><span class="n">ct</span><span class="o">.</span><span class="n">G</span><span class="o">*</span><span class="n">mbh</span><span class="o">*</span><span class="n">obj</span><span class="o">.</span><span class="n">rho</span><span class="o">*</span><span class="n">xi</span><span class="o">/</span><span class="n">gamma</span>
    <span class="n">lam</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">sqrt</span><span class="p">(</span><span class="mi">2</span><span class="o">*</span><span class="n">xi</span><span class="o">/</span><span class="p">(</span><span class="mi">3</span><span class="o">*</span><span class="n">gamma</span><span class="o">*</span><span class="n">obj</span><span class="o">.</span><span class="n">Omega</span><span class="p">))</span>

    <span class="n">dP</span> <span class="o">=</span> <span class="o">-</span><span class="n">dPdR</span><span class="p">(</span><span class="n">obj</span><span class="p">)</span>
    <span class="n">xc</span> <span class="o">=</span> <span class="n">dP</span><span class="o">*</span><span class="n">obj</span><span class="o">.</span><span class="n">h</span><span class="o">*</span><span class="n">obj</span><span class="o">.</span><span class="n">h</span><span class="o">/</span><span class="p">(</span><span class="mi">3</span><span class="o">*</span><span class="n">gamma</span><span class="o">*</span><span class="n">obj</span><span class="o">.</span><span class="n">R</span><span class="p">)</span>

    <span class="c1"># eta = -dSigmadR(obj)/3 + (-dTdR(obj) + 3)/6</span>
    <span class="c1"># xc = eta*obj.h*obj.h/obj.R</span>
    <span class="n">kes</span> <span class="o">=</span> <span class="n">electron_scattering_opacity</span><span class="p">(</span><span class="n">X</span><span class="o">=</span><span class="mf">0.7</span><span class="p">)</span>
    <span class="n">L</span> <span class="o">=</span> <span class="mi">4</span> <span class="o">*</span> <span class="n">np</span><span class="o">.</span><span class="n">pi</span> <span class="o">*</span> <span class="n">ct</span><span class="o">.</span><span class="n">G</span> <span class="o">*</span> <span class="n">ct</span><span class="o">.</span><span class="n">c</span> <span class="o">*</span> <span class="n">mbh</span> <span class="o">/</span> <span class="n">kes</span>
    <span class="n">g_thermal</span> <span class="o">=</span> <span class="mf">1.61</span><span class="o">*</span><span class="p">(</span><span class="n">gamma</span> <span class="o">-</span> <span class="mi">1</span><span class="p">)</span><span class="o">*</span><span class="n">xc</span><span class="o">*</span><span class="p">(</span><span class="n">L</span><span class="o">/</span><span class="n">Lc</span> <span class="o">-</span> <span class="mi">1</span><span class="p">)</span><span class="o">/</span><span class="p">(</span><span class="n">gamma</span><span class="o">*</span><span class="n">lam</span><span class="p">)</span>
    <span class="k">return</span> <span class="n">g_thermal</span>
</pre></div>
</div>
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="o">%%capture</span>
<span class="n">disk_name</span> <span class="o">=</span> <span class="p">[</span><span class="s1">&#39;sirko&#39;</span><span class="p">,</span> <span class="s1">&#39;thompson&#39;</span><span class="p">]</span>
<span class="n">d_counter</span> <span class="o">=</span> <span class="mi">0</span>

<span class="n">f</span><span class="p">,</span> <span class="n">axes</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">subplots</span><span class="p">(</span><span class="mi">4</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="n">figsize</span><span class="o">=</span><span class="p">(</span><span class="mi">10</span><span class="p">,</span> <span class="mi">10</span><span class="p">),</span> <span class="n">sharex</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">sharey</span><span class="o">=</span><span class="s1">&#39;row&#39;</span><span class="p">,</span> <span class="n">gridspec_kw</span><span class="o">=</span><span class="nb">dict</span><span class="p">(</span><span class="n">hspace</span><span class="o">=</span><span class="mi">0</span><span class="p">,</span> <span class="n">wspace</span> <span class="o">=</span><span class="mi">0</span><span class="p">,</span> <span class="n">height_ratios</span> <span class="o">=</span> <span class="p">(</span><span class="mi">2</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="mf">1.2</span><span class="p">)),</span> <span class="n">tight_layout</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
<span class="k">for</span> <span class="n">axx</span> <span class="ow">in</span> <span class="n">axes</span><span class="o">.</span><span class="n">flatten</span><span class="p">():</span>
    <span class="n">axx</span><span class="o">.</span><span class="n">set_yscale</span><span class="p">(</span><span class="s1">&#39;log&#39;</span><span class="p">)</span>
    <span class="n">axx</span><span class="o">.</span><span class="n">set_xscale</span><span class="p">(</span><span class="s1">&#39;log&#39;</span><span class="p">)</span>

<span class="k">for</span> <span class="n">dname</span> <span class="ow">in</span> <span class="n">disk_name</span><span class="p">:</span>
    <span class="n">Mbh</span> <span class="o">=</span> <span class="mf">1e6</span>
    <span class="n">q</span> <span class="o">=</span> <span class="mf">5e-6</span>

    <span class="c1">#generate the disk values for both AGN disk models using pagn</span>
    <span class="k">if</span> <span class="n">dname</span> <span class="o">==</span> <span class="s1">&#39;thompson&#39;</span><span class="p">:</span>
        <span class="n">objin</span> <span class="o">=</span> <span class="n">Thompson</span><span class="o">.</span><span class="n">ThompsonAGN</span><span class="p">(</span><span class="n">Mbh</span> <span class="o">=</span> <span class="n">Mbh</span><span class="o">*</span><span class="n">ct</span><span class="o">.</span><span class="n">MSun</span><span class="p">,</span> <span class="n">Mdot_out</span><span class="o">=</span><span class="mf">0.</span><span class="p">,)</span> <span class="c1">#Sirko.SirkoAGN(Mbh = Mbh, b=0)  #</span>
        <span class="n">rout</span> <span class="o">=</span> <span class="n">objin</span><span class="o">.</span><span class="n">Rs</span><span class="o">*</span><span class="p">(</span><span class="mf">1e7</span><span class="p">)</span>
        <span class="n">sigma</span> <span class="o">=</span> <span class="mi">200</span> <span class="o">*</span> <span class="p">(</span><span class="n">Mbh</span> <span class="o">/</span> <span class="mf">1.3e8</span><span class="p">)</span> <span class="o">**</span> <span class="p">(</span><span class="mi">1</span> <span class="o">/</span> <span class="mf">4.24</span><span class="p">)</span>
        <span class="n">Mdot_out</span> <span class="o">=</span> <span class="mf">1.5e-2</span>
        <span class="n">obj</span> <span class="o">=</span> <span class="n">Thompson</span><span class="o">.</span><span class="n">ThompsonAGN</span><span class="p">(</span><span class="n">Mbh</span><span class="o">=</span><span class="n">Mbh</span><span class="o">*</span><span class="n">ct</span><span class="o">.</span><span class="n">MSun</span><span class="p">,</span> <span class="n">Rout</span> <span class="o">=</span> <span class="n">rout</span><span class="p">,</span> <span class="n">Mdot_out</span><span class="o">=</span><span class="n">Mdot_out</span><span class="o">*</span><span class="n">ct</span><span class="o">.</span><span class="n">MSun</span><span class="o">/</span><span class="n">ct</span><span class="o">.</span><span class="n">yr</span><span class="p">)</span>  <span class="c1"># Sirko.SirkoAGN(Mbh = Mbh, b=0)  #</span>
        <span class="n">obj</span><span class="o">.</span><span class="n">solve_disk</span><span class="p">(</span><span class="n">N</span><span class="o">=</span><span class="mf">1e4</span><span class="p">)</span> <span class="p">;</span>
    <span class="k">else</span><span class="p">:</span>
        <span class="n">le</span> <span class="o">=</span> <span class="mf">0.5</span>
        <span class="n">alpha</span> <span class="o">=</span> <span class="mf">0.01</span>
        <span class="n">obj</span> <span class="o">=</span> <span class="n">Sirko</span><span class="o">.</span><span class="n">SirkoAGN</span><span class="p">(</span><span class="n">Mbh</span><span class="o">=</span><span class="n">Mbh</span><span class="o">*</span><span class="n">ct</span><span class="o">.</span><span class="n">MSun</span><span class="p">,</span> <span class="n">le</span><span class="o">=</span><span class="n">le</span><span class="p">,</span> <span class="n">alpha</span><span class="o">=</span><span class="n">alpha</span><span class="p">,</span> <span class="n">b</span><span class="o">=</span><span class="mi">0</span><span class="p">)</span>
        <span class="n">obj</span><span class="o">.</span><span class="n">solve_disk</span><span class="p">(</span><span class="n">N</span><span class="o">=</span><span class="mf">1e4</span><span class="p">)</span> <span class="p">;</span>

    <span class="n">Gamma_0</span> <span class="o">=</span> <span class="n">gamma_0</span><span class="p">(</span><span class="n">q</span><span class="p">,</span> <span class="n">obj</span><span class="o">.</span><span class="n">h</span> <span class="o">/</span> <span class="n">obj</span><span class="o">.</span><span class="n">R</span><span class="p">,</span> <span class="mi">2</span> <span class="o">*</span> <span class="n">obj</span><span class="o">.</span><span class="n">rho</span> <span class="o">*</span> <span class="n">obj</span><span class="o">.</span><span class="n">h</span><span class="p">,</span> <span class="n">obj</span><span class="o">.</span><span class="n">R</span><span class="p">,</span> <span class="n">obj</span><span class="o">.</span><span class="n">Omega</span><span class="p">)</span>

    <span class="c1">#Grishin et al 2023 equations</span>
    <span class="n">dSig</span> <span class="o">=</span> <span class="n">dSigmadR</span><span class="p">(</span><span class="n">obj</span><span class="p">)</span>
    <span class="n">dT</span> <span class="o">=</span> <span class="n">dTdR</span><span class="p">(</span><span class="n">obj</span><span class="p">)</span>
    <span class="n">cI_p10</span> <span class="o">=</span> <span class="n">CI_p10</span><span class="p">(</span><span class="n">dSig</span><span class="p">,</span> <span class="n">dT</span><span class="p">)</span>
    <span class="n">Gamma_I_p10</span> <span class="o">=</span> <span class="n">cI_p10</span><span class="o">*</span><span class="n">Gamma_0</span>
    <span class="n">gamma</span> <span class="o">=</span> <span class="mi">5</span><span class="o">/</span><span class="mi">3</span>

    <span class="n">cI_jm_tot</span> <span class="o">=</span> <span class="n">CI_jm17_tot</span><span class="p">(</span><span class="n">dSig</span><span class="p">,</span> <span class="n">dT</span><span class="p">,</span> <span class="n">gamma</span><span class="p">,</span> <span class="n">obj</span><span class="p">)</span>
    <span class="n">Gamma_I_jm_tot</span> <span class="o">=</span> <span class="n">cI_jm_tot</span><span class="o">*</span><span class="n">Gamma_0</span>
    <span class="n">Gamma_therm</span> <span class="o">=</span> <span class="n">gamma_thermal</span><span class="p">(</span><span class="n">gamma</span><span class="p">,</span> <span class="n">obj</span><span class="p">,</span> <span class="n">q</span><span class="p">)</span><span class="o">*</span><span class="n">Gamma_0</span><span class="o">*</span><span class="n">obj</span><span class="o">.</span><span class="n">R</span><span class="o">/</span><span class="n">obj</span><span class="o">.</span><span class="n">h</span>

    <span class="n">Gamma_tot</span> <span class="o">=</span> <span class="n">Gamma_therm</span> <span class="o">+</span> <span class="n">Gamma_I_jm_tot</span>

    <span class="c1">#-----Plotting-----#</span>


    <span class="n">linestyles</span> <span class="o">=</span> <span class="p">[</span><span class="s1">&#39;-&#39;</span><span class="p">,</span> <span class="s1">&#39;--&#39;</span><span class="p">,</span> <span class="s1">&#39;-.&#39;</span><span class="p">,</span> <span class="s1">&#39;:&#39;</span><span class="p">]</span>
    <span class="n">ax</span> <span class="o">=</span> <span class="n">axes</span><span class="p">[:,</span> <span class="n">d_counter</span><span class="p">]</span>
    <span class="k">if</span> <span class="nb">hasattr</span><span class="p">(</span><span class="n">obj</span><span class="p">,</span> <span class="s1">&#39;alpha&#39;</span><span class="p">):</span>
        <span class="n">ax</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">text</span><span class="p">(</span><span class="mi">10</span> <span class="o">**</span> <span class="mf">1.2</span><span class="p">,</span> <span class="mi">10</span> <span class="o">**</span> <span class="mi">40</span><span class="p">,</span>  <span class="sa">r</span><span class="s1">&#39;${\rm Sirko \, and \, Goodman}$&#39;</span> <span class="p">)</span>
    <span class="k">else</span><span class="p">:</span>
        <span class="n">ax</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">text</span><span class="p">(</span><span class="mi">10</span> <span class="o">**</span> <span class="mf">1.2</span><span class="p">,</span> <span class="mi">10</span> <span class="o">**</span> <span class="mi">40</span><span class="p">,</span>  <span class="sa">r</span><span class="s1">&#39;${\rm Thompson}$&#39;</span><span class="p">)</span>

    <span class="k">for</span> <span class="n">iGamma</span><span class="p">,</span> <span class="n">Gamma</span> <span class="ow">in</span> <span class="nb">enumerate</span><span class="p">([</span><span class="n">Gamma_I_jm_tot</span><span class="p">,</span> <span class="n">Gamma_therm</span><span class="p">,</span> <span class="n">Gamma_tot</span><span class="p">]):</span>
        <span class="n">maskg</span> <span class="o">=</span> <span class="n">Gamma</span> <span class="o">&gt;=</span> <span class="mi">0</span>
        <span class="n">indices</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">nonzero</span><span class="p">(</span><span class="n">maskg</span><span class="p">[</span><span class="mi">1</span><span class="p">:]</span> <span class="o">!=</span> <span class="n">maskg</span><span class="p">[:</span><span class="o">-</span><span class="mi">1</span><span class="p">])[</span><span class="mi">0</span><span class="p">]</span> <span class="o">+</span> <span class="mi">1</span>
        <span class="n">Gammas</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">split</span><span class="p">(</span><span class="n">Gamma</span><span class="p">,</span> <span class="n">indices</span><span class="p">)</span>
        <span class="n">Rs</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">split</span><span class="p">(</span><span class="n">obj</span><span class="o">.</span><span class="n">R</span><span class="p">,</span> <span class="n">indices</span><span class="p">)</span>
        <span class="n">ignnum</span> <span class="o">=</span> <span class="mi">0</span>
        <span class="n">ignum2</span> <span class="o">=</span> <span class="mi">0</span>
        <span class="k">for</span> <span class="n">iseg</span><span class="p">,</span> <span class="n">seg</span> <span class="ow">in</span> <span class="nb">enumerate</span><span class="p">(</span><span class="n">Gammas</span><span class="p">):</span>
            <span class="k">if</span> <span class="n">seg</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="o">&gt;</span> <span class="mf">0.</span><span class="p">:</span>
                <span class="k">if</span> <span class="n">Rs</span><span class="p">[</span><span class="n">iseg</span><span class="p">][</span><span class="mi">0</span><span class="p">]</span> <span class="o">/</span> <span class="n">obj</span><span class="o">.</span><span class="n">Rs</span> <span class="o">&gt;</span> <span class="n">ignnum</span> <span class="o">+</span> <span class="mi">50</span><span class="p">:</span>
                    <span class="n">ax</span><span class="p">[</span><span class="n">iGamma</span><span class="p">]</span><span class="o">.</span><span class="n">axvline</span><span class="p">(</span><span class="n">Rs</span><span class="p">[</span><span class="n">iseg</span><span class="p">][</span><span class="mi">0</span><span class="p">]</span> <span class="o">/</span> <span class="n">obj</span><span class="o">.</span><span class="n">Rs</span><span class="p">,</span> <span class="o">-</span><span class="mi">100</span><span class="p">,</span> <span class="mi">100</span><span class="p">,</span> <span class="n">color</span> <span class="o">=</span> <span class="s1">&#39;k&#39;</span><span class="p">,</span> <span class="n">alpha</span> <span class="o">=</span> <span class="mf">0.1</span><span class="p">)</span>
                    <span class="n">ignnum</span> <span class="o">=</span> <span class="n">Rs</span><span class="p">[</span><span class="n">iseg</span><span class="p">][</span><span class="mi">0</span><span class="p">]</span> <span class="o">/</span> <span class="n">obj</span><span class="o">.</span><span class="n">Rs</span>

                <span class="n">ax</span><span class="p">[</span><span class="n">iGamma</span><span class="p">]</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">Rs</span><span class="p">[</span><span class="n">iseg</span><span class="p">]</span><span class="o">/</span><span class="n">obj</span><span class="o">.</span><span class="n">Rs</span><span class="p">,</span> <span class="nb">abs</span><span class="p">(</span><span class="n">seg</span><span class="p">)</span><span class="o">*</span><span class="n">ct</span><span class="o">.</span><span class="n">SI_to_gcm2</span><span class="p">,</span> <span class="n">c</span><span class="o">=</span><span class="s1">&#39;C0&#39;</span><span class="p">,</span> <span class="n">zorder</span> <span class="o">=</span> <span class="mi">2</span><span class="p">)</span>
                <span class="k">if</span> <span class="n">iGamma</span> <span class="o">==</span> <span class="mi">2</span> <span class="ow">and</span> <span class="n">Rs</span><span class="p">[</span><span class="n">iseg</span><span class="p">][</span><span class="mi">0</span><span class="p">]</span> <span class="o">/</span> <span class="n">obj</span><span class="o">.</span><span class="n">Rs</span> <span class="o">&gt;</span> <span class="n">ignum2</span> <span class="o">+</span> <span class="mi">50</span><span class="p">:</span>
                    <span class="n">ax</span><span class="p">[</span><span class="mi">3</span><span class="p">]</span><span class="o">.</span><span class="n">axvline</span><span class="p">(</span><span class="n">Rs</span><span class="p">[</span><span class="n">iseg</span><span class="p">][</span><span class="mi">0</span><span class="p">]</span> <span class="o">/</span> <span class="n">obj</span><span class="o">.</span><span class="n">Rs</span><span class="p">,</span> <span class="o">-</span><span class="mi">100</span><span class="p">,</span> <span class="mi">100</span><span class="p">,</span> <span class="n">color</span><span class="o">=</span><span class="s1">&#39;k&#39;</span><span class="p">,</span> <span class="n">alpha</span><span class="o">=</span><span class="mf">0.1</span><span class="p">)</span>
                    <span class="n">ignum2</span> <span class="o">=</span> <span class="n">Rs</span><span class="p">[</span><span class="n">iseg</span><span class="p">][</span><span class="mi">0</span><span class="p">]</span> <span class="o">/</span> <span class="n">obj</span><span class="o">.</span><span class="n">Rs</span>

            <span class="k">else</span><span class="p">:</span>
                <span class="n">ax</span><span class="p">[</span><span class="n">iGamma</span><span class="p">]</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">Rs</span><span class="p">[</span><span class="n">iseg</span><span class="p">]</span> <span class="o">/</span> <span class="n">obj</span><span class="o">.</span><span class="n">Rs</span><span class="p">,</span> <span class="nb">abs</span><span class="p">(</span><span class="n">seg</span><span class="o">*</span><span class="n">ct</span><span class="o">.</span><span class="n">SI_to_gcm2</span><span class="p">)</span> <span class="p">,</span> <span class="n">c</span><span class="o">=</span><span class="s1">&#39;C1&#39;</span><span class="p">,</span> <span class="n">zorder</span> <span class="o">=</span> <span class="mi">2</span><span class="p">)</span>
        <span class="k">if</span> <span class="n">iGamma</span> <span class="o">==</span> <span class="mi">0</span><span class="p">:</span>
            <span class="n">Gamma2</span> <span class="o">=</span> <span class="n">Gamma_I_p10</span>
            <span class="n">maskg2</span> <span class="o">=</span> <span class="n">Gamma2</span> <span class="o">&gt;=</span> <span class="mi">0</span>
            <span class="n">indices2</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">nonzero</span><span class="p">(</span><span class="n">maskg2</span><span class="p">[</span><span class="mi">1</span><span class="p">:]</span> <span class="o">!=</span> <span class="n">maskg2</span><span class="p">[:</span><span class="o">-</span><span class="mi">1</span><span class="p">])[</span><span class="mi">0</span><span class="p">]</span> <span class="o">+</span> <span class="mi">1</span>
            <span class="n">Gammas2</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">split</span><span class="p">(</span><span class="n">Gamma2</span><span class="p">,</span> <span class="n">indices2</span><span class="p">)</span>
            <span class="n">Rs2</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">split</span><span class="p">(</span><span class="n">obj</span><span class="o">.</span><span class="n">R</span><span class="p">,</span> <span class="n">indices2</span><span class="p">)</span>
            <span class="k">for</span> <span class="n">iseg2</span><span class="p">,</span> <span class="n">seg2</span> <span class="ow">in</span> <span class="nb">enumerate</span><span class="p">(</span><span class="n">Gammas2</span><span class="p">):</span>

                <span class="k">if</span> <span class="n">seg2</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="o">&gt;</span> <span class="mf">0.</span><span class="p">:</span>
                    <span class="n">ax</span><span class="p">[</span><span class="n">iGamma</span><span class="p">]</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">Rs2</span><span class="p">[</span><span class="n">iseg2</span><span class="p">]</span> <span class="o">/</span> <span class="n">obj</span><span class="o">.</span><span class="n">Rs</span><span class="p">,</span> <span class="nb">abs</span><span class="p">(</span><span class="n">seg2</span><span class="p">),</span> <span class="n">c</span><span class="o">=</span><span class="s1">&#39;C0&#39;</span><span class="p">,</span> <span class="n">zorder</span> <span class="o">=</span> <span class="mi">1</span><span class="p">,</span> <span class="n">alpha</span> <span class="o">=</span> <span class="mf">0.4</span><span class="p">)</span>
                <span class="k">else</span><span class="p">:</span>
                    <span class="n">ax</span><span class="p">[</span><span class="n">iGamma</span><span class="p">]</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">Rs2</span><span class="p">[</span><span class="n">iseg2</span><span class="p">]</span> <span class="o">/</span> <span class="n">obj</span><span class="o">.</span><span class="n">Rs</span><span class="p">,</span> <span class="nb">abs</span><span class="p">(</span><span class="n">seg2</span><span class="p">),</span> <span class="n">c</span><span class="o">=</span><span class="s1">&#39;C1&#39;</span><span class="p">,</span> <span class="n">zorder</span> <span class="o">=</span> <span class="mi">1</span><span class="p">,</span> <span class="n">alpha</span> <span class="o">=</span> <span class="mf">0.4</span><span class="p">)</span>
    <span class="n">ax</span><span class="p">[</span><span class="mi">3</span><span class="p">]</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">obj</span><span class="o">.</span><span class="n">R</span><span class="o">/</span><span class="n">obj</span><span class="o">.</span><span class="n">Rs</span><span class="p">,</span> <span class="mi">2</span><span class="o">*</span><span class="n">obj</span><span class="o">.</span><span class="n">h</span><span class="o">*</span><span class="n">obj</span><span class="o">.</span><span class="n">rho</span><span class="o">*</span><span class="n">ct</span><span class="o">.</span><span class="n">SI_to_gcm2</span><span class="p">,</span> <span class="n">label</span> <span class="o">=</span> <span class="sa">r</span><span class="s2">&quot;$\Sigma_{\rm g} [{\rm g cm}^{-2}]$&quot;</span><span class="p">)</span>


    <span class="n">d_counter</span> <span class="o">+=</span> <span class="mi">1</span>

<span class="n">pos_line</span> <span class="o">=</span> <span class="n">mlines</span><span class="o">.</span><span class="n">Line2D</span><span class="p">([],</span> <span class="p">[],</span> <span class="n">color</span><span class="o">=</span><span class="s1">&#39;C0&#39;</span><span class="p">,</span> <span class="n">marker</span><span class="o">=</span><span class="s1">&#39;s&#39;</span><span class="p">,</span>
                           <span class="n">markersize</span><span class="o">=</span><span class="mi">0</span><span class="p">,</span> <span class="n">label</span><span class="o">=</span><span class="sa">r</span><span class="s1">&#39;$\rm</span><span class="si">{Inward}</span><span class="s1">$&#39;</span><span class="p">)</span>
<span class="n">neg_line</span> <span class="o">=</span> <span class="n">mlines</span><span class="o">.</span><span class="n">Line2D</span><span class="p">([],</span> <span class="p">[],</span> <span class="n">color</span><span class="o">=</span><span class="s1">&#39;C1&#39;</span><span class="p">,</span> <span class="n">marker</span><span class="o">=</span><span class="s1">&#39;s&#39;</span><span class="p">,</span>
                            <span class="n">markersize</span><span class="o">=</span><span class="mi">0</span><span class="p">,</span> <span class="n">label</span><span class="o">=</span><span class="sa">r</span><span class="s1">&#39;$\rm</span><span class="si">{Outward}</span><span class="s1">$&#39;</span><span class="p">)</span>
<span class="n">artists_handles</span> <span class="o">=</span> <span class="p">[</span><span class="n">pos_line</span><span class="p">,</span> <span class="n">neg_line</span><span class="p">]</span>
<span class="n">axes</span><span class="p">[</span><span class="mi">2</span><span class="p">,</span> <span class="mi">1</span><span class="p">]</span><span class="o">.</span><span class="n">legend</span><span class="p">(</span><span class="n">handles</span><span class="o">=</span><span class="n">artists_handles</span><span class="p">,</span> <span class="n">framealpha</span> <span class="o">=</span> <span class="mi">1</span><span class="p">)</span>

<span class="n">pos_line2</span> <span class="o">=</span> <span class="n">mlines</span><span class="o">.</span><span class="n">Line2D</span><span class="p">([],</span> <span class="p">[],</span> <span class="n">color</span><span class="o">=</span><span class="s1">&#39;C0&#39;</span><span class="p">,</span> <span class="n">marker</span><span class="o">=</span><span class="s1">&#39;s&#39;</span><span class="p">,</span> <span class="n">alpha</span> <span class="o">=</span> <span class="mf">0.4</span><span class="p">,</span>
                         <span class="n">markersize</span><span class="o">=</span><span class="mi">0</span><span class="p">,)</span>
<span class="n">neg_line2</span> <span class="o">=</span> <span class="n">mlines</span><span class="o">.</span><span class="n">Line2D</span><span class="p">([],</span> <span class="p">[],</span> <span class="n">color</span><span class="o">=</span><span class="s1">&#39;C1&#39;</span><span class="p">,</span> <span class="n">marker</span><span class="o">=</span><span class="s1">&#39;s&#39;</span><span class="p">,</span> <span class="n">alpha</span> <span class="o">=</span> <span class="mf">0.4</span><span class="p">,</span>
                         <span class="n">markersize</span><span class="o">=</span><span class="mi">0</span><span class="p">,)</span>
<span class="kn">from</span> <span class="nn">matplotlib.legend_handler</span> <span class="kn">import</span> <span class="n">HandlerLine2D</span><span class="p">,</span> <span class="n">HandlerTuple</span>
<span class="n">axes</span><span class="p">[</span><span class="mi">0</span><span class="p">,</span><span class="mi">1</span><span class="p">]</span><span class="o">.</span><span class="n">legend</span><span class="p">(</span><span class="n">handles</span><span class="o">=</span><span class="p">[(</span><span class="n">pos_line</span><span class="p">,</span> <span class="n">neg_line</span><span class="p">),</span> <span class="p">(</span><span class="n">pos_line2</span><span class="p">,</span> <span class="n">neg_line2</span><span class="p">,)</span> <span class="p">],</span>
                 <span class="n">labels</span><span class="o">=</span><span class="p">[</span><span class="sa">r</span><span class="s1">&#39;${\rm Jim \acute</span><span class="si">{e}</span><span class="s1"> nez \, and \, Masset \, (2017)}$&#39;</span><span class="p">,</span> <span class="sa">r</span><span class="s1">&#39;$\rm Paardekooper \, et \, al. \, (2010)$&#39;</span><span class="p">,],</span>
                 <span class="n">handler_map</span> <span class="o">=</span> <span class="p">{</span><span class="nb">tuple</span><span class="p">:</span> <span class="n">HandlerTuple</span><span class="p">(</span><span class="n">ndivide</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span> <span class="n">pad</span> <span class="o">=</span> <span class="mf">0.</span><span class="p">)},</span>
                 <span class="n">framealpha</span> <span class="o">=</span> <span class="mi">1</span><span class="p">)</span>

<span class="n">axes</span><span class="p">[</span><span class="mi">0</span><span class="p">,</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">set_ylabel</span><span class="p">(</span><span class="sa">r</span><span class="s1">&#39;${\Gamma_{\rm I} \, {\rm [g \, cm}^</span><span class="si">{2}</span><span class="s1">{\rm s}^{-2}{\rm ]} }$&#39;</span><span class="p">)</span>
<span class="n">axes</span><span class="p">[</span><span class="mi">1</span><span class="p">,</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">set_ylabel</span><span class="p">(</span><span class="sa">r</span><span class="s1">&#39;${\Gamma_{\rm therm} \, {\rm [g \, cm}^</span><span class="si">{2}</span><span class="s1">{\rm s}^{-2}{\rm ]} }$&#39;</span><span class="p">)</span>
<span class="n">axes</span><span class="p">[</span><span class="mi">2</span><span class="p">,</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">set_ylabel</span><span class="p">(</span><span class="sa">r</span><span class="s1">&#39;${\Gamma_{\rm tot} \, {\rm [g \, cm}^</span><span class="si">{2}</span><span class="s1">{\rm s}^{-2}{\rm ]} }$&#39;</span><span class="p">)</span>
<span class="n">axes</span><span class="p">[</span><span class="mi">3</span><span class="p">,</span> <span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">set_ylabel</span><span class="p">(</span><span class="sa">r</span><span class="s1">&#39;$\Sigma_{\rm g} [{\rm g \, cm}^{-2}]$&#39;</span><span class="p">)</span>

<span class="n">x_label</span> <span class="o">=</span> <span class="sa">r</span><span class="s2">&quot;$r \, [R_{\rm s}]$&quot;</span>
<span class="n">axes</span><span class="p">[</span><span class="mi">3</span><span class="p">,</span> <span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">set_xlabel</span><span class="p">(</span><span class="n">x_label</span><span class="p">)</span>
<span class="n">axes</span><span class="p">[</span><span class="mi">3</span><span class="p">,</span> <span class="mi">1</span><span class="p">]</span><span class="o">.</span><span class="n">set_xlabel</span><span class="p">(</span><span class="n">x_label</span><span class="p">)</span>

<span class="n">axes</span><span class="p">[</span><span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">set_ylim</span><span class="p">((</span><span class="mf">1e25</span><span class="p">,</span> <span class="mf">1e42</span><span class="p">))</span>


<span class="n">axes</span><span class="p">[</span><span class="mi">1</span><span class="p">,</span> <span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">set_ylim</span><span class="p">((</span><span class="mf">5e24</span><span class="p">,</span> <span class="mf">1e42</span><span class="p">))</span>

<span class="n">axes</span><span class="p">[</span><span class="mi">2</span><span class="p">,</span> <span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">set_ylim</span><span class="p">((</span><span class="mf">1e25</span><span class="p">,</span> <span class="mf">1e42</span><span class="p">))</span>


<span class="n">axes</span><span class="p">[</span><span class="mi">3</span><span class="p">,</span> <span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">set_ylim</span><span class="p">((</span><span class="mf">1e1</span><span class="p">,</span> <span class="mf">1e7</span><span class="p">))</span>

<span class="k">for</span> <span class="n">axx</span> <span class="ow">in</span> <span class="n">axes</span><span class="o">.</span><span class="n">flatten</span><span class="p">():</span>
    <span class="n">axx</span><span class="o">.</span><span class="n">yaxis</span><span class="o">.</span><span class="n">set_ticks_position</span><span class="p">(</span><span class="s1">&#39;both&#39;</span><span class="p">)</span>
    <span class="n">axx</span><span class="o">.</span><span class="n">xaxis</span><span class="o">.</span><span class="n">set_ticks_position</span><span class="p">(</span><span class="s1">&#39;both&#39;</span><span class="p">)</span>
    <span class="n">axx</span><span class="o">.</span><span class="n">set_xlim</span><span class="p">((</span><span class="mf">1e1</span><span class="p">,</span> <span class="mf">1e7</span><span class="p">))</span>
<span class="n">axes</span><span class="p">[</span><span class="mi">0</span><span class="p">,</span><span class="mi">1</span><span class="p">]</span><span class="o">.</span><span class="n">set_xlim</span><span class="p">((</span><span class="mf">1.1e1</span><span class="p">,</span> <span class="mf">1e7</span><span class="p">))</span>

<span class="n">f</span><span class="o">.</span><span class="n">align_ylabels</span><span class="p">()</span>
</pre></div>
</div>
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">f</span>
</pre></div>
</div>
<img alt="_images/output_43_0.png" src="_images/output_43_0.png" />
</section>
</section>


           </div>
          </div>
          <footer><div class="rst-footer-buttons" role="navigation" aria-label="Footer">
        <a href="index.html" class="btn btn-neutral float-left" title="pAGN" accesskey="p" rel="prev"><span class="fa fa-arrow-circle-left" aria-hidden="true"></span> Previous</a>
        <a href="api.html" class="btn btn-neutral float-right" title="API" accesskey="n" rel="next">Next <span class="fa fa-arrow-circle-right" aria-hidden="true"></span></a>
    </div>

  <hr/>

  <div role="contentinfo">
    <p>&#169; Copyright 2024, A. A. Trani, D. Gangardt, C. Bonnerot, D. Gerosa.</p>
  </div>

  Built with <a href="https://www.sphinx-doc.org/">Sphinx</a> using a
    <a href="https://github.com/readthedocs/sphinx_rtd_theme">theme</a>
    provided by <a href="https://readthedocs.org">Read the Docs</a>.
   

</footer>
        </div>
      </div>
    </section>
  </div>
  <script>
      jQuery(function () {
          SphinxRtdTheme.Navigation.enable(true);
      });
  </script> 

</body>
</html>